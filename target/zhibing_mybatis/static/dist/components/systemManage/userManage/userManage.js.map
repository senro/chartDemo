{"version":3,"sources":["/components/systemManage/userManage/userManage.jsx"],"names":[],"mappings":"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","file":"/components/systemManage/userManage/userManage.jsx","sourcesContent":["\r\nvar $ = require('egis-jquery');\r\nrequire('egis-bootstrap/confirmation')();\r\nrequire('egis-bootstrap')();\r\nvar ajax = require('egis-ajax').ajax;\r\nvar pagination = require('egis-pagination');\r\nvar template = require('egis-template');\r\nvar loadCss = require('egis-load-css');\r\nvar checkbox = require('egis-checkbox');\r\n//var validateForm=require('egis-validate').validateForm;\r\nvar systemMessage=require('egis-system-message');\r\nvar xhr = require('egis-xhr'),\r\n    clearEmptyValue = xhr.clearEmptyValue;\r\n//var utilUser = require('components/util/utilUser');\r\nvar $aside = $('aside');\r\nvar Vue=require('vue');\r\nvar getQueryString=require('egis-get-query-string');\r\nvar regs=require('egis-validate/regs');\r\nvar validateForm=require('egis-validate').validateForm;\r\n\r\nfunction render(){\r\n    $aside.html(__inline('./userManage.html'));\r\n\r\n    var $searchForm = $('#searchForm'),\r\n        $pageNum = $searchForm.find('input[name=page]'),\r\n        $pageSize = $searchForm.find('input[name=size]'),\r\n        $pagination = $('#pagination');\r\n    /*列表展示*/\r\n    var listRender=template.compile($('#list-tpl').html());\r\n    $searchForm.on('submit', function (event) {\r\n        var $context = $(this),\r\n            $submit = $context.find('input[type=submit]');\r\n\r\n        if (event) {\r\n            event.preventDefault();\r\n        }\r\n        if ($submit.prop(\"disabled\")) {\r\n            return false;\r\n        }\r\n        ajax(\r\n            window.apiHost+'users/listUser.do',\r\n            clearEmptyValue($context),\r\n            function (data) {\r\n                var dataObj = data.data || {};\r\n\r\n                $('.page-userManage #listTable').find('tbody').html(listRender(dataObj));\r\n\r\n\r\n                /*删除*/\r\n                $('.page-userManage #listTable .btn-delete').confirmation({\r\n                    btnOkLabel: '确认',\r\n                    btnCancelLabel: '取消',\r\n                    onShow: function (event, element) {\r\n\r\n                    },\r\n                    onHide: function (event, element) {\r\n\r\n                    },\r\n                    onConfirm: function (event, element) {\r\n                        var id =$(element).attr('data-id');\r\n                        var name=$(element).attr('data-name');\r\n                        if(name!='superDevAdmin'){\r\n                            ajax(\r\n                                window.apiHost+'users/deleteUser.do',\r\n                                {id:id},\r\n                                function (data) {\r\n                                    $searchForm.trigger('submit');\r\n                                    systemMessage.info(\"删除用户成功！\");\r\n                                },\r\n                                null,null,'get'\r\n                            );\r\n                        }else{\r\n                            systemMessage.alert(\"此管理员不能被删除！\");\r\n                        }\r\n                    }\r\n                });\r\n\r\n                //分页\r\n                $('#pagination-content').pagination({\r\n                    $form:$context,\r\n                    first: \"<<\",\r\n                    prev : \"<\",\r\n                    next : \">\",\r\n                    last : \">>\",\r\n                    pageSize:parseInt($pageSize.val()),\r\n                    totalSize:dataObj.totalElements,\r\n                    info: true,\r\n                    infoContainer:'.pagination-wrap',\r\n                    paginationInfoTpl:\r\n                    '<div class=\"pagination-TotalInfo\">总条数 '+dataObj.totalElements+' 条</div>'+\r\n                    '<div class=\"pagination-info-content\">' +\r\n                    '<input type=\"text\" class=\"info-currentPage\" name=\"currentPage\" />' +\r\n                    '&nbsp;/&nbsp;'+ dataObj.totalPages +'页&nbsp;&nbsp;' +\r\n                    '<a href=\"javascript:;\" class=\"info-goToPage\">GO</a>' +\r\n                    '</div>',\r\n                    visiblePages: 5,\r\n                    onPageClick: function (event, page) {\r\n                        $pageNum.val(page);\r\n                        $context.trigger('submit');\r\n                    }\r\n                });\r\n\r\n            },\r\n            function () {\r\n                $submit.prop(\"disabled\", true);          // 禁用\r\n            },function(){\r\n                $submit.prop(\"disabled\", false);         // 启用\r\n            },'get'\r\n        );\r\n    }).trigger('submit');\r\n    \r\n    var model_User = {\r\n        id:0,\r\n        email:'',\r\n        name: \"\",\r\n        password: \"\",\r\n        rePassword: \"\",\r\n        roleId: \"\"\r\n    };\r\n    var $addUserModal=$('#modal-addUser');\r\n\r\n    //用vueJs 实现双向同步\r\n    //Vue.config.debug = false;\r\n    function initVue(){\r\n        return new Vue({\r\n            el: '#modal-addUser',\r\n            data: model_User\r\n        });\r\n    }\r\n    initVue();\r\n    //新增用户\r\n    var submitType='add';\r\n\r\n    $('.btn-addUser').click(function(){\r\n        $addUserModal.modal('show');\r\n        $addUserModal.find('.modal-title').html('新增用户');\r\n        $addUserModal.find('form')[0].reset();\r\n        submitType='add';\r\n        return false;\r\n    });\r\n\r\n    $('.page-userManage').on('click','.btn-updateUser',function(){\r\n        $addUserModal.modal('show');\r\n        $addUserModal.find('.modal-title').html('修改用户');\r\n        $addUserModal.find('form')[0].reset();\r\n        submitType='edit';\r\n        var id=$(this).attr('data-id');\r\n\r\n        //获取用户详情\r\n        ajax(\r\n            window.apiHost+'users/getUserById.do',\r\n            {\r\n                id:id\r\n            },\r\n            function (data) {\r\n                var dataObj = data.data || {};\r\n                model_User= $.extend(model_User,dataObj);\r\n            },\r\n            function () {\r\n\r\n            },function(){\r\n\r\n            },'post'\r\n        );\r\n        return false;\r\n    });\r\n\r\n    $addUserModal.find('.btn-addUserConfirm').click(function(){\r\n        var $this=$(this);\r\n        if(!$this.hasClass('disable')){\r\n            if(validateForm($addUserModal.find('form'))){\r\n                if(model_User.password==model_User.rePassword){\r\n                    var url,msg;\r\n                    if(submitType=='add'){\r\n                        url=window.apiHost+'users/addUser.do';\r\n                        msg='新增用户成功！';\r\n                    }else{\r\n                        url=window.apiHost+'users/updateUser.do';\r\n                        msg='修改用户成功！';\r\n                    }\r\n                    ajax(\r\n                        url,\r\n                        model_User,\r\n                        function (data) {\r\n                            var dataObj = data.data || {};\r\n                            systemMessage.info(msg);\r\n                            $addUserModal.modal('hide');\r\n                            $searchForm.trigger('submit');\r\n                        },\r\n                        function () {\r\n                            $this.prop(\"disabled\", true);          // 禁用\r\n                        },function(){\r\n                            $this.prop(\"disabled\", false);         // 启用\r\n                        },'post'\r\n                    );\r\n                }else{\r\n                    systemMessage.alert(\"两次密码不相同！\");\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        return false;\r\n    });\r\n}\r\n\r\n//module.exports={\r\n//    render:render\r\n//};\r\n\r\nexports.render = render;\r\n"]}