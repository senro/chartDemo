function doGenTsc(e,t,n,r,o){tscSdkObj=new TSCObject(t),partnerCode="000",tscSdkObj.init(partnerCode,e,n,r,o),tscSdkObj.generateTscCode()}function showTime(){}function showStar(){}function doGenerateInternal(){var e=""+(new Date).getTime(),t=parseInt(e.substring(0,e.length-3))-g_PGS_TimeOffset,n=generateDynamicCode(g_PGS_DeviceId,t,g_PGS_UserToken,g_PGS_UserToken,g_PGS_PartCode,g_PGS_Version),r=g_PGS_Type+n;generateQRcode(r),jQuery("#qrcodeNum").text(r)}function generateQRcode(e){var t=256,n=256,r="#efefef",o="#424647";g_options.width&&(t=g_options.width),g_options.height&&(n=g_options.height),g_options.foreground&&(o=g_options.foreground),g_options.background&&(r=g_options.background),jQuery("#qrcodeCanvas").empty(),jQuery("#qrcodeCanvas").qrcode({width:t,height:n,background:r,foreground:o,text:e})}function doGenerate(e,t,n,r,o,_,i){g_PGS_Type=e,g_PGS_DeviceId=t,g_PGS_UserToken=n,g_PGS_PartCode=r,g_PGS_TimeOffset=o,g_PGS_Version=_,g_options=i,g_options||(g_options={});var s=setInterval(doGenerateInternal,1e3);return doGenerateInternal(),s}function generateToken(e,t,n){for(var r="",o=t+e+n,_=hex_md5(o),i=0,s=0;i<_.length&&6>s;){var a=_[i++];isNaN(a)||(r+=a,s++)}return r}function generateDynamicCode(e,t,n,r,o,_){if(8!=r.length)return null;var i=generateToken(e,t,n),s=r+i,a=encodeNumberID(s,o.substr(0,3),_);return a}function b64_hmac_sha1(e,t){return binb2b64(core_hmac_sha1(e,t))}function core_sha1(e,t){e[t>>5]|=128<<24-t%32,e[(t+64>>9<<4)+15]=t;for(var n=Array(80),r=1732584193,o=-271733879,_=-1732584194,i=271733878,s=-1009589776,a=0;a<e.length;a+=16){for(var c=r,d=o,h=_,p=i,g=s,f=0;80>f;f++){n[f]=16>f?e[a+f]:rol(n[f-3]^n[f-8]^n[f-14]^n[f-16],1);var u=safe_add(safe_add(rol(r,5),sha1_ft(f,o,_,i)),safe_add(safe_add(s,n[f]),sha1_kt(f)));s=i,i=_,_=rol(o,30),o=r,r=u}r=safe_add(r,c),o=safe_add(o,d),_=safe_add(_,h),i=safe_add(i,p),s=safe_add(s,g)}return Array(r,o,_,i,s)}function sha1_ft(e,t,n,r){return 20>e?t&n|~t&r:40>e?t^n^r:60>e?t&n|t&r|n&r:t^n^r}function sha1_kt(e){return 20>e?1518500249:40>e?1859775393:60>e?-1894007588:-899497514}function core_hmac_sha1(e,t){var n=str2binb(e);n.length>16&&(n=core_sha1(n,e.length*chrsz));for(var r=Array(16),o=Array(16),_=0;16>_;_++)r[_]=909522486^n[_],o[_]=1549556828^n[_];var i=core_sha1(r.concat(str2binb(t)),512+t.length*chrsz);return core_sha1(o.concat(i),672)}function safe_add(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}function rol(e,t){return e<<t|e>>>32-t}function str2binb(e){for(var t=Array(),n=(1<<chrsz)-1,r=0;r<e.length*chrsz;r+=chrsz)t[r>>5]|=(e.charCodeAt(r/chrsz)&n)<<32-chrsz-r%32;return t}function binb2b64(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",r=0;r<4*e.length;r+=3)for(var o=(e[r>>2]>>8*(3-r%4)&255)<<16|(e[r+1>>2]>>8*(3-(r+1)%4)&255)<<8|e[r+2>>2]>>8*(3-(r+2)%4)&255,_=0;4>_;_++)n+=8*r+6*_>32*e.length?b64pad:t.charAt(o>>6*(3-_)&63);return n}var TSCObject=function(e){this.p_device_id,this.p_device_id_time,this.p_session_id,this.p_time_offset,this.p_schedule_fun_id,this.p_tsc_code_fun_id,this.p_check_did_fun_id,this.p_relogin_schedule=9e5,this.p_partnerCode,this.p_appId,this.p_externalId,this.p_sdc_version="10",this.p_api_type,this.p_user_token,this.qr_options={},this.cloud_app_key="de82967019906571ae879c460358e148",e&&(this.qr_options=e)};TSCObject.prototype.init=function(e,t,n,r,o){this.p_partnerCode=e,this.p_api_type=t,this.p_device_id=n,this.p_user_token=r,this.p_time_offset=o},TSCObject.prototype.getSessionId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})},TSCObject.prototype.generateTscCode=function(){this.sdc_login(this)},TSCObject.prototype.tscFunc=function(){this.sdc_login(this)},TSCObject.prototype.sig=function(e){var t=encodeURIComponent(e);return t=t.replace("*","%2A"),t=t.replace(" ","%20"),b64_hmac_sha1(this.cloud_app_key+"&",t)},TSCObject.prototype.sdc_login=function(e){clearInterval(e.p_tsc_code_fun_id),e.p_tsc_code_fun_id=doGenerate(e.p_api_type,e.p_device_id,e.p_user_token,e.p_partnerCode,e.p_time_offset,e.p_sdc_version,e.qr_options)};var tscSdkObj,g_PGS_Type="",g_PGS_DeviceId="",g_PGS_UserToken="",g_PGS_PartCode="",g_PGS_TimeOffset=0,g_PGS_Version="",g_PGS_Width=256,g_PGS_Height=256,g_options={},hexcase=0,b64pad="=",chrsz=8;