function doGenerateInternal(){var e=""+Date.now(),n=parseInt(e.substring(0,e.length-3))-g_PGS_TimeOffset,o=generateDynamicCode(g_PGS_DeviceId,n,g_PGS_UserToken,g_PGS_UserToken,g_PGS_PartCode,g_PGS_Version),r=g_PGS_Type+o;generateQRcode(r),jQuery("#qrcodeNum").text(r)}function generateQRcode(e){var n=256,o=256,r="#efefef",t="#424647";g_options.width&&(n=g_options.width),g_options.height&&(o=g_options.height),g_options.foreground&&(t=g_options.foreground),g_options.background&&(r=g_options.background),jQuery("#qrcodeCanvas").empty(),jQuery("#qrcodeCanvas").qrcode({width:n,height:o,background:r,foreground:t,text:e})}function doGenerate(e,n,o,r,t,_,g){g_PGS_Type=e,g_PGS_DeviceId=n,g_PGS_UserToken=o,g_PGS_PartCode=r,g_PGS_TimeOffset=t,g_PGS_Version=_,g_options=g,g_options||(g_options={});var i=setInterval(doGenerateInternal,1e3);return doGenerateInternal(),i}function generateToken(e,n,o){for(var r="",t=n+e+o,_=hex_md5(t),g=0,i=0;g<_.length&&6>i;){var a=_[g++];isNaN(a)||(r+=a,i++)}return r}function generateDynamicCode(e,n,o,r,t,_){if(8!=r.length)return null;var g=generateToken(e,n,o),i=r+g,a=encodeNumberID(i,t.substr(0,3),_);return a}var g_PGS_Type="",g_PGS_DeviceId="",g_PGS_UserToken="",g_PGS_PartCode="",g_PGS_TimeOffset=0,g_PGS_Version="",g_options={};