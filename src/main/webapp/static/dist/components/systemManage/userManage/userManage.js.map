{"version":3,"sources":["/components/systemManage/userManage/userManage.jsx"],"names":[],"mappings":"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","file":"/components/systemManage/userManage/userManage.jsx","sourcesContent":["\nvar $ = require('egis-jquery');\nrequire('egis-bootstrap/confirmation')();\nrequire('egis-bootstrap')();\nvar ajax=require('components/util/ajax').ajax;\n\nrequire('egis-pagination')($);\nvar template = require('egis-template');\nvar loadCss = require('egis-load-css');\nvar checkbox = require('egis-checkbox');\n//var validateForm=require('egis-validate').validateForm;\nvar systemMessage=require('egis-system-message');\nvar xhr = require('egis-xhr'),\n    clearEmptyValue = xhr.clearEmptyValue;\n//var utilUser = require('components/util/utilUser');\nvar $aside = $('aside');\nvar Vue=require('vue1.x/dist/vue');\nvar getQueryString=require('egis-get-query-string');\nvar regs=require('egis-validate/regs');\nvar validateForm=require('egis-validate').validateForm;\n\nfunction render(){\n    $aside.html(__inline('./userManage.html'));\n\n    var $searchForm = $('#searchForm'),\n        $pageNum = $searchForm.find('input[name=page]'),\n        $pageSize = $searchForm.find('input[name=size]'),\n        $pagination = $('#pagination');\n    /*列表展示*/\n    var listRender=template.compile($('#list-tpl').html());\n    $searchForm.on('submit', function (event) {\n        var $context = $(this),\n            $submit = $context.find('input[type=submit]');\n\n        if (event) {\n            event.preventDefault();\n        }\n        if ($submit.prop(\"disabled\")) {\n            return false;\n        }\n        ajax(\n            window.apiHost+'users/listUser.do',\n            clearEmptyValue($context),\n            function (data) {\n                var dataObj = data.data || {};\n\n                $('.page-userManage #listTable').find('tbody').html(listRender(dataObj));\n\n\n                /*删除*/\n                $('.page-userManage #listTable .btn-delete').confirmation({\n                    btnOkLabel: '确认',\n                    btnCancelLabel: '取消',\n                    onShow: function (event, element) {\n\n                    },\n                    onHide: function (event, element) {\n\n                    },\n                    onConfirm: function (event, element) {\n                        var id =$(element).attr('data-id');\n                        var name=$(element).attr('data-name');\n                        if(name!='superDevAdmin'){\n                            ajax(\n                                window.apiHost+'users/deleteUser.do',\n                                {id:id},\n                                function (data) {\n                                    $searchForm.trigger('submit');\n                                    systemMessage.info(\"删除用户成功！\");\n                                },\n                                null,null,'get'\n                            );\n                        }else{\n                            systemMessage.alert(\"此管理员不能被删除！\");\n                        }\n                    }\n                });\n\n                //分页\n                $('#pagination-content').pagination({\n                    $form:$context,\n                    first: \"<<\",\n                    prev : \"<\",\n                    next : \">\",\n                    last : \">>\",\n                    pageSize:parseInt($pageSize.val()),\n                    totalSize:dataObj.totalElements,\n                    info: true,\n                    infoContainer:'.pagination-wrap',\n                    paginationInfoTpl:\n                    '<div class=\"pagination-TotalInfo\">总条数 '+dataObj.totalElements+' 条</div>'+\n                    '<div class=\"pagination-info-content\">' +\n                    '<input type=\"text\" class=\"info-currentPage\" name=\"currentPage\" />' +\n                    '&nbsp;/&nbsp;'+ dataObj.totalPages +'页&nbsp;&nbsp;' +\n                    '<a href=\"javascript:;\" class=\"info-goToPage\">GO</a>' +\n                    '</div>',\n                    visiblePages: 5,\n                    onPageClick: function (event, page) {\n                        $pageNum.val(page);\n                        $context.trigger('submit');\n                    }\n                });\n\n            },\n            function () {\n                $submit.prop(\"disabled\", true);          // 禁用\n            },function(){\n                $submit.prop(\"disabled\", false);         // 启用\n            },'get'\n        );\n    }).trigger('submit');\n    \n    var model_User = {\n        id:0,\n        email:'',\n        name: \"\",\n        password: \"\",\n        rePassword: \"\",\n        roleId: \"\"\n    };\n    var $addUserModal=$('#modal-addUser');\n\n    //用vueJs 实现双向同步\n    //Vue.config.debug = false;\n    function initVue(){\n        return new Vue({\n            el: '#modal-addUser',\n            data: model_User\n        });\n    }\n    initVue();\n    //新增用户\n    var submitType='add';\n\n    $('.btn-addUser').click(function(){\n        $addUserModal.modal('show');\n        $addUserModal.find('.modal-title').html('新增用户');\n        $addUserModal.find('form')[0].reset();\n        submitType='add';\n        return false;\n    });\n\n    $('.page-userManage').on('click','.btn-updateUser',function(){\n        $addUserModal.modal('show');\n        $addUserModal.find('.modal-title').html('修改用户');\n        $addUserModal.find('form')[0].reset();\n        submitType='edit';\n        var id=$(this).attr('data-id');\n\n        //获取用户详情\n        ajax(\n            window.apiHost+'users/getUserById.do',\n            {\n                id:id\n            },\n            function (data) {\n                var dataObj = data.data || {};\n                model_User= $.extend(model_User,dataObj);\n            },\n            function () {\n\n            },function(){\n\n            },'post'\n        );\n        return false;\n    });\n\n    $addUserModal.find('.btn-addUserConfirm').click(function(){\n        var $this=$(this);\n        if(!$this.hasClass('disable')){\n            if(validateForm($addUserModal.find('form'))){\n                if(model_User.password==model_User.rePassword){\n                    var url,msg;\n                    if(submitType=='add'){\n                        url=window.apiHost+'users/addUser.do';\n                        msg='新增用户成功！';\n                    }else{\n                        url=window.apiHost+'users/updateUser.do';\n                        msg='修改用户成功！';\n                    }\n                    ajax(\n                        url,\n                        model_User,\n                        function (data) {\n                            var dataObj = data.data || {};\n                            systemMessage.info(msg);\n                            $addUserModal.modal('hide');\n                            $searchForm.trigger('submit');\n                        },\n                        function () {\n                            $this.prop(\"disabled\", true);          // 禁用\n                        },function(){\n                            $this.prop(\"disabled\", false);         // 启用\n                        },'post'\n                    );\n                }else{\n                    systemMessage.alert(\"两次密码不相同！\");\n                }\n\n            }\n        }\n\n        return false;\n    });\n}\n\n//module.exports={\n//    render:render\n//};\n\nexports.render = render;\n"]}