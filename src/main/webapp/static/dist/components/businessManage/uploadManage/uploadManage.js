define("components/businessManage/uploadManage/uploadManage",function(n,t,a){function e(){function n(){return new m({el:"#modal-addData",data:g})}u.hide().html('\r\n<div class="page page-uploadManage">\r\n    <div class="page-tit">\r\n        <form role="form" class="page-tit-form" id="searchForm">\r\n            上传管理\r\n            <input type="hidden" name="page" value="1">\r\n            <input type="hidden" name="size" value="20">\r\n            <input type="hidden" name="order" value="desc">\r\n            <a href="javascript:;" class="btn btn-primary pull-right btn-addData" id="btn-addData">\r\n                <span class="glyphicon glyphicon-plus"></span>\r\n                新增数据\r\n            </a>\r\n        </form>\r\n    </div>\r\n    <div class="page-cont">\r\n        <table id="listTable" class="merchant-manage default-list box table table-hover table-bordered">\r\n            <thead>\r\n            <tr>\r\n                <th>医院名称</th>\r\n                <th>数据所属月份</th>\r\n                <th>数据地址</th>\r\n                <th>\r\n                    修改日期\r\n                    <a class="btn-list-sort" href="javascript:;" title="排序">\r\n                        <span class="glyphicon glyphicon-sort"></span>\r\n                    </a>\r\n                </th>\r\n                <th>操作</th>\r\n            </tr>\r\n            <tbody>\r\n\r\n                <script id="list-tpl" type="text/html">\r\n                    {{ if loading }}\r\n                    <tr>\r\n                        <td colspan="5">\r\n                            <span class="icon-loading"></span>\r\n                        </td>\r\n                    </tr>\r\n                    {{ else if items && items.length > 0 }}\r\n                    {{each items as item i}}\r\n                    {{ if i%2==0 }}\r\n                    <tr>\r\n                        {{ else }}\r\n                    <tr class="trBg">\r\n                        {{ /if }}\r\n                        <td>\r\n                            <a class="color-lightBlue" title="{{ item.hospitalName }}">\r\n                                {{ item.hospitalName }}\r\n                            </a>\r\n                        </td>\r\n                        <td>\r\n                            <a class="color-lightBlue" title="{{ item.month }}">\r\n                                {{ item.month }}\r\n                            </a>\r\n                        </td>\r\n                        <td>\r\n                            <a href="{{ item.dataUrl }}" title="{{ item.dataUrl }}">\r\n                                下载\r\n                            </a>\r\n                        </td>\r\n\r\n                        <td>\r\n                            <span title="{{ item.updateAt }}">\r\n                                {{ item.updateAt }}\r\n                            </span>\r\n                        </td>\r\n                        <td>\r\n                            {{ if item.validate=="yes" }}\r\n                                <a class="btn btn-info btn-transparent btn-validate" href="javascript:;" title="是否合理" data-validate="{{ item.validate }}" data-id="{{ item.id }}">\r\n                                    <span class="glyphicon glyphicon-eye-open"></span>\r\n                                </a>\r\n                            {{ else }}\r\n                                <a class="btn btn-info btn-transparent btn-validate" href="javascript:;" title="是否合理" data-validate="{{ item.validate }}" data-id="{{ item.id }}">\r\n                                    <span class="glyphicon glyphicon-eye-close"></span>\r\n                                </a>\r\n                            {{ /if }}\r\n\r\n                            <a class="btn btn-info btn-transparent btn-modify btn-updateData" href="javascript:;" title="编辑数据" data-id="{{ item.id }}">\r\n                                <span class="glyphicon glyphicon-edit"></span>\r\n                            </a>\r\n                            <a class="btn btn-info btn-transparent btn-deleteData" title="删除数据" data-id="{{ item.id }}" data-placement="left" data-toggle="confirmation" data-original-title="确认删除?">\r\n                                <span class="glyphicon glyphicon-trash"></span>\r\n                            </a>\r\n                        </td>\r\n                    </tr>\r\n                    {{/each}}\r\n                    {{else}}\r\n                    <tr>\r\n                        <td colspan="5">未搜索到符合该条件的记录！</td>\r\n                    </tr>\r\n                    {{ /if }}\r\n                </script>\r\n\r\n            </tbody>\r\n        </table>\r\n\r\n        <div id="pagination" class="pagination-wrap">\r\n            <ul id="pagination-content" class="page_box">\r\n\r\n            </ul>\r\n        </div>\r\n\r\n    </div>\r\n</div>\r\n\r\n<!--上传excel弹框-->\r\n<div class="modal fade modal-addData" id="modal-addData" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\r\n    <div class="modal-dialog">\r\n        <div class="modal-content">\r\n            <div class="modal-header clearfix">\r\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\r\n                <h4 class="modal-title">新增数据</h4>\r\n            </div>\r\n            <div class="modal-body">\r\n                <form class="" action="" id="modal-addData-form">\r\n                    <table class="modal-table modal-addRoller-table">\r\n                        <tr class="row-hospitalName none">\r\n                            <td class="text-right">医院名称</td>\r\n                            <td>\r\n                                <select class="form-control" id="userId" name="userId" v-model="userId">\r\n                                    <script type="text/html" id="user-list-tpl">\r\n                                        {{ if items && items.length > 0 }}\r\n                                        <option value="0">请选择</option>\r\n                                        {{ each items as item i }}\r\n                                        <option value="{{item.id}}">\r\n                                            {{ item.name }}\r\n                                        </option>\r\n                                        {{ /each }}\r\n                                        {{ else }}\r\n                                        <option value="">\r\n                                            没有查到名称\r\n                                        </option>\r\n                                        {{ /if }}\r\n                                    </script>\r\n                                </select>\r\n                            </td>\r\n                            <td class="color-red">\r\n                                <!--<span class="color-red">*</span>-->\r\n                                <!--<span class="errorMsg"></span>-->\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="text-right">数据年份</td>\r\n                            <td>\r\n                                <select class="form-control mt10" name="year" v-model="year" required="required" data-vd-msg="请选择年份！">\r\n                                    <option value="">请选择</option>\r\n                                    <option value="2015">2015</option>\r\n                                    <option value="2016">2016</option>\r\n                                    <option value="2017">2017</option>\r\n                                    <option value="2018">2018</option>\r\n                                    <option value="2019">2019</option>\r\n                                    <option value="2020">2020</option>\r\n                                    <option value="2021">2021</option>\r\n                                    <option value="2022">2022</option>\r\n                                </select>\r\n                            </td>\r\n                            <td class="color-red">\r\n                                <!--<span class="color-red">*</span>-->\r\n                                <!--<span class="errorMsg"></span>-->\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="text-right">数据月份</td>\r\n                            <td>\r\n                                <select class="form-control mt10" name="month" v-model="month" required="required" data-vd-msg="请选择月份！">\r\n                                    <option value="">请选择</option>\r\n                                    <option value="01">1月</option>\r\n                                    <option value="02">2月</option>\r\n                                    <option value="03">3月</option>\r\n                                    <option value="04">4月</option>\r\n                                    <option value="05">5月</option>\r\n                                    <option value="06">6月</option>\r\n                                    <option value="07">7月</option>\r\n                                    <option value="08">8月</option>\r\n                                    <option value="09">9月</option>\r\n                                    <option value="10">10月</option>\r\n                                    <option value="11">11月</option>\r\n                                    <option value="12">12月</option>\r\n                                </select>\r\n                            </td>\r\n                            <td class="color-red">\r\n                                <!--<span class="color-red">*</span>-->\r\n                                <!--<span class="errorMsg"></span>-->\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="text-right">上传数据</td>\r\n                            <td class="privileges">\r\n                                <input type="hidden" v-model="id" name="id"/>\r\n                                <input type="hidden" v-model="fileKey" readonly required="required" data-vd-msg="请上传数据！" name="fileKey"/>\r\n                                <input id="fileupload" type="file" class="none" name="file" hidden="hidden" multiple>\r\n                                <span>{{fileKey}}</span>\r\n                                <!--<a href="{{dataUrl}}" target="_blank">下载</a>-->\r\n                            </td>\r\n                            <td class="color-red">\r\n                                <span class="errorMsg"></span>\r\n                            </td>\r\n                        </tr>\r\n                    </table>\r\n                </form>\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button type="button" class="btn btn-gray btn-cancel" data-dismiss="modal">取消</button>\r\n                <button type="button" class="btn btn-lightBlue btn-addDataConfirm">确认</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n').fadeIn(500);var t=i(".page-uploadManage"),a=i("#searchForm"),e=a.find("input[name=page]"),p=a.find("input[name=size]"),f=(i("#pagination"),o.compile(i("#list-tpl").html()));a.on("submit",function(n){var o=i(this),l=o.find("input[type=submit]");return n&&n.preventDefault(),l.prop("disabled")?!1:void r(window.apiHost+"data/listData.do",o.serializeArray(),function(n){var l=n.data||{};t.find("#listTable").find("tbody").html(f(l)),t.find("#listTable .btn-deleteData").confirmation({btnOkLabel:"确认",btnCancelLabel:"取消",onShow:function(){},onHide:function(){},onConfirm:function(n,t){var e=i(t).attr("data-id");r(window.apiHost+"data/deleteData.do",{id:e},function(){s.info("删除成功！"),a.trigger("submit")},null,null,"get")}}),t.find("#pagination-content").pagination({$form:o,first:"<<",prev:"<",next:">",last:">>",pageSize:parseInt(p.val()),totalSize:l.totalElements,info:!0,infoContainer:".pagination-wrap",paginationInfoTpl:'<div class="pagination-TotalInfo">总条数 '+l.totalElements+' 条</div><div class="pagination-info-content"><input type="text" class="info-currentPage" name="currentPage" />&nbsp;/&nbsp;'+l.totalPages+'页&nbsp;&nbsp;<a href="javascript:;" class="info-goToPage">GO</a></div>',visiblePages:5,onPageClick:function(n,t){e.val(t),o.trigger("submit")}})},function(){l.prop("disabled",!0),i("#listTable").find("tbody").html(f({loading:!0}))},function(){l.prop("disabled",!1)},"post")}).trigger("submit");var v=i("input[name=order]");i(".btn-list-sort").click(function(){return"desc"==v.val()?(v.val("asc"),i(this).removeClass("active")):(v.val("desc"),i(this).addClass("active")),a.trigger("submit"),!1});var g={id:0,userId:0,year:"2016",month:"",fileKey:""},h=i("#modal-addData"),b=o.compile(i("#user-list-tpl").html());r(window.apiHost+"users/listUser.do",null,function(n){var t=n.data||{};i("#userId").html(b(t))},null,null,"post"),c.start(),1==c.loginInfo.roleId&&i(".row-hospitalName").show(),n();var y="add";i(".btn-addData").click(function(){return h.modal("show"),h.find(".modal-title").html("新增数据"),h.find("form")[0].reset(),g.fileKey="",y="add",!1}),t.on("click",".btn-validate",function(){var n=i(this).attr("data-id"),t=i(this).attr("data-validate");return r(window.apiHost+"data/updateData.do",{id:n,validate:"yes"==t?"no":"yes"},function(){s.info("设置为"+("yes"==t?"不":"")+"合理！"),a.trigger("submit")},function(){},function(){},"post"),!1}),t.on("click",".btn-updateData",function(){h.modal("show"),h.find(".modal-title").html("修改数据"),y="edit";var n=i(this).attr("data-id");return r(window.apiHost+"data/getDataById.do",{id:n},function(n){var t=n.data||{};g=i.extend(g,t)},function(){},function(){},"post"),!1}),h.find(".btn-addDataConfirm").click(function(){var n=i(this);if(!n.hasClass("disable")&&d(h.find("form"))){var t,e;"add"==y?(t=window.apiHost+"data/addData.do",e="新增数据成功！"):(t=window.apiHost+"data/updateData.do",e="修改数据成功！");{new Date}g.preMonth=l.normalizeToSingleNum(g.month)-1!=0?g.year+"-"+l.normalizeSingleNum(l.normalizeToSingleNum(g.month)-1)+"-01":g.year+"-"+g.month+"-01",g.month=g.year+"-"+l.normalizeSingleNum(g.month)+"-01",r(t,g,function(n){n.data||{};s.info(e),h.modal("hide"),a.trigger("submit")},function(){n.prop("disabled",!0)},function(){n.prop("disabled",!1)},"post")}return!1}),i("#btn-addFile").click(function(){return i("#fileupload").click(),!1}),i("#fileupload").change(function(){/\.xls|\.xlsx/.test(i("#fileupload").val())?i("#fileupload").fileupload("enable"):(i("#fileupload").fileupload("disable"),s.error("请上传一个excel文件！"))}),i("#fileupload").fileupload({url:window.apiHost+"web/uploadFile.do",dataType:"json",done:function(n,t){var t=t.result;1==t.status?(s.info("上传文件成功！"),g.fileKey=t.data):s.error(t.detail)}})}var i=n("node_modules/egis-jquery/jquery");n("node_modules/egis-bootstrap/confirmation")(),n("node_modules/egis-bootstrap/bootstrap")(),n("node_modules/egis-datetimepicker/datetimepicker")(i),n("node_modules/egis-jquery-file-upload/jquery.fileupload")(i);var r=n("components/util/ajax").ajax;n("node_modules/egis-pagination/pagination")(i);var o=n("node_modules/egis-template/template"),l=(n("node_modules/egis-load-css/load-css"),n("node_modules/egis-checkbox/checkbox"),n("node_modules/egis-date-extend/date-extend")),d=n("node_modules/egis-validate/validate").validateForm,s=(n("node_modules/egis-formvars/formvars"),n("node_modules/egis-system-message/system-message")),p=n("node_modules/egis-xhr/xhr"),c=(p.clearEmptyValue,n("components/util/utilUser")),u=i("aside"),m=n("node_modules/vue1.x/dist/vue");a.exports={render:e}});